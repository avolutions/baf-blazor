@using Avolutions.Baf.Core.Identity.Caching
@using Avolutions.Baf.Core.Identity.Models
@using MudBlazor

@inject IUserCache UserCache

<MudStack Row="true" AlignItems="AlignItems.Center" Spacing="2">
    <MudAvatar 
        Size="Size"
        Style="@($"background-color:{UserInfo.AvatarColor.Background}; color:{UserInfo.AvatarColor.Text};")">
        @UserInfo.Initials
    </MudAvatar>

    @if (WithName)
    {
        <MudText Typo="@Typo">@UserInfo.Name</MudText>
    }
</MudStack>

@code {
    [Parameter] public required Size Size { get; set; } = Size.Large;
    [Parameter] public Typo Typo { get; set; } = Typo.body1;
    [Parameter] public required Guid UserId { get; set; }
    [Parameter] public bool WithName { get; set; }
    
    private UserInfo UserInfo { get; set; } = null!;

    protected override void OnParametersSet()
    {
        UserInfo = UserCache.Get(UserId);
    }
}